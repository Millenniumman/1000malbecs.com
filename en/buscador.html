<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta content="Busca los mejores Malbecs de Argentina por provincia, región, bodega y más." name="description"/>
    <title>1000malbecs - Buscador de Vinos</title>
    <meta content="Buscador de los mejores Malbecs argentinos, desde Patagonia hasta Puna" property="og:title"/>
    <meta content="Explora y filtra nuestra selección de Malbecs por provincia, región, bodega, año y variedad." property="og:description"/>
    <meta content="https://www.1000malbecs.com/images/l000-malbecs-logo.png" property="og:image"/>
    <meta content="image/png" property="og:image:type"/>
    <meta content="1200" property="og:image:width"/>
    <meta content="630" property="og:image:height"/>
    <meta content="https://www.1000malbecs.com/es/buscador.html" property="og:url"/>
    <meta content="website" property="og:type"/>
    <meta content="summary_large_image" name="twitter:card"/>
    <meta content="1000 Malbecs - Buscador de Vinos" name="twitter:title"/>
    <meta content="Filtra y descubre los mejores Malbecs argentinos." name="twitter:description"/>
    <meta content="https://www.1000malbecs.com/images/l000-malbecs-logo.png" name="twitter:image"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet"/>
    <link href="/css/styles.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="/js/wine-search.js"></script>
    <script src="/js/global.js" defer></script>
    <style>
        body { font-family: 'Montserrat', sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; min-height: 100vh; }
        .header { top: 50px; z-index: 120; display: flex; justify-content: flex-end; position: relative; }
        .logo { max-width: 150px; height: auto; }
        .hamburger { display: none; font-size: 24px; background: none; border: none; color: #4A2C59; cursor: pointer; padding: 10px; position: fixed; top: 15px; left: 10px; z-index: 130; }
        #sidebar { width: 250px; background-color: #F8F8F8; padding: 20px; height: 100vh; position: fixed; top: 0; left: 0; overflow-y: auto; border-right: 1px solid #E0E0E0; z-index: 100; transition: transform 0.3s ease; }
        .logo-container { text-align: center; margin-bottom: 20px; }
        main { margin-left: 290px; padding: 20px; width: calc(100% - 290px); flex: 1; }
        main h1 { font-size: 24px; color: #4A2C59; margin-bottom: 20px; }
        .section-title { font-size: 22px; color: #4A2C59; margin: 20px 0 10px; text-align: center; text-transform: uppercase; }
        .product-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 30px; margin-bottom: 30px; width: 100%; justify-content: start; }
        .product-card { background-color: #FFFFFF; border: 1px solid #E0E0E0; border-radius: 5px; padding: 15px; padding-bottom: 20px; position: relative; overflow: visible; max-width: 250px; min-height: 360px; display: flex; flex-direction: column; justify-content: space-between; align-items: center; z-index: 5; box-shadow: 0 2px 5px rgba(0,0,0,0.1); box-sizing: border-box; width: 100%; }
        .product-card img { width: 200px; height: 200px; object-fit: contain; margin: 0 auto; }
        .info-icon { position: absolute; top: 10px; right: 10px; font-size: 20px; cursor: pointer; z-index: 10; display: none; color: #4A2C59; background-color: rgba(255, 255, 255, 0.8); border-radius: 50%; width: 40px; height: 40px; line-height: 40px; text-align: center; touch-action: manipulation; pointer-events: auto; }
        .overlay { display: none; position: absolute; top: 0; left: 0; width: 100%; max-height: 150px; background-color: rgba(74, 44, 89, 0.8); color: #FFFFFF; padding: 40px 10px 10px 10px; box-sizing: border-box; font-size: 12px; overflow-y: auto; z-index: 6; pointer-events: none; }
        .overlay p { margin: 2px 0; color: #FFFFFF; text-align: left; }
        .product-card:hover .overlay { display: block; }
        .product-card .overlay.active { display: block !important; }
        .product-card h3 { font-size: 16px; margin: 10px 0; color: #4A2C59; min-height: 40px; overflow: hidden; text-overflow: ellipsis; white-space: normal; text-align: center; width: 100%; }
        .product-card .price { font-size: 16px; color: #4A2C59; margin: 10px 0; position: relative; z-index: 7; text-align: center; width: 100%; }
        .product-card .buy-button { padding: 8px 16px; font-size: 14px; margin-top: 10px; margin-bottom: 15px; position: relative; z-index: 7; text-align: center; background-color: #4A2C59; color: #f5e6ff; text-decoration: none; border-radius: 5px; pointer-events: auto; width: 100%; max-width: 180px; display: block; }
        .product-card .buy-button:hover { background-color: #5A1D39; }
        .filters { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
        .filters select { padding: 8px; border: 1px solid #E0E0E0; border-radius: 5px; width: 200px; }
        .filters button { background-color: #4A2C59; color: #f5e6ff; padding: 8px 16px; border-radius: 5px; border: none; cursor: pointer; }
        .language-selector { display: flex; gap: 10px; position: fixed; top: 10px; right: 10px; z-index: 1000; margin: 10px; justify-content: flex-end; }
        .language-selector a { display: inline-block; visibility: visible; text-decoration: none; color: #333; font-size: 16px; padding: 5px 10px; border: 1px solid #ccc; border-radius: 4px; transition: background-color 0.3s; }
        .language-selector a:hover { background-color: #f0f0f0; }
        .language-selector a.active { background-color: #6200ea; color: white; }
        @media (max-width: 768px) {
            main { margin-left: 0; margin-top: 60px; padding: 10px; width: 100%; }
            .header { top: 10px; left: auto; right: 10px; display: flex; justify-content: flex-end; z-index: 120; }
            .logo { max-width: 80px !important; height: auto !important; display: block; }
            .hamburger { display: block !important; z-index: 130; }
            #sidebar { width: 100%; height: 100vh; position: fixed; top: 0; left: 0; transform: translateX(-100%); z-index: 100; border-bottom: 1px solid #E0E0E0; padding-top: 50px; padding-bottom: 20px; overflow-y: auto; box-sizing: border-box; }
            #sidebar.open { transform: translateX(0); }
            .logo-container { display: none; }
            .product-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; justify-content: start; }
            .product-card { width: 100%; max-width: none; height: 260px; min-height: auto; padding: 10px; box-sizing: border-box; overflow: hidden; position: relative; align-items: center; }
            .product-card img { width: 140px; height: 140px; margin: 0 auto; }
            .product-card h3 { font-size: 14px; min-height: 36px; margin: 5px 0; text-align: center; width: 100%; }
            .product-card .price { font-size: 14px; margin: 5px 0; text-align: center; width: 100%; }
            .product-card .buy-button { padding: 6px 12px; font-size: 12px; margin-top: 5px; margin-bottom: 5px; pointer-events: auto; width: 100%; max-width: 140px; display: block; }
            .info-icon { display: block !important; pointer-events: auto; z-index: 10; }
            .overlay { max-height: 150px; pointer-events: auto; width: 100%; box-sizing: border-box; top: 0; padding: 40px 10px 10px 10px; display: none; z-index: 6; }
            .overlay.active { display: block !important; z-index: 6; }
            .product-card:hover .overlay { display: none; }
            .language-selector { position: static; width: 100%; text-align: center; margin: 10px 0; z-index: 1000; max-width: 100%; overflow: visible; }
            .filters select { width: 100%; max-width: 150px; }
        }
        @media (min-width: 769px) {
            .header { display: none; }
            .logo-container { display: block; }
            .info-icon { display: none; }
            .hamburger { display: none; }
            .product-grid { grid-template-columns: repeat(4, 1fr); gap: 30px; max-width: 1200px; justify-content: start; }
            .product-card { pointer-events: auto; max-width: 250px; min-height: 360px; width: 100%; padding: 15px; display: flex; flex-direction: column; justify-content: space-between; align-items: center; box-sizing: border-box; }
            .product-card img { width: 200px; height: 200px; margin: 0 auto; }
        }
        .error-message { color: red; text-align: center; margin: 20px 0; }
    </style>
</head>
<body x-data="wineSearch()">
    <div class="language-selector">
        <a aria-label="Español" class="active" data-lang="es" href="/es/buscador.html">ES 🇪🇸</a>
        <a aria-label="Alemán" data-lang="de" href="/de/buscador.html">DE 🇩🇪</a>
        <a aria-label="Inglés" data-lang="en" href="/en/buscador.html">EN 🇬🇧</a>
    </div>
    <header class="header">
        <a href="/es/" title="Volver al inicio">
            <img alt="1000malbecs Logo" class="logo" src="/images/l000-malbecs-logo.png" onerror="this.src='https://via.placeholder.com/80x80?text=Logo+Not+Available';">
        </a>
    </header>
    <button class="hamburger">☰</button>
    <main>
        <h1>Buscador de Vinos</h1>
        <section class="filters">
            <select name="provincia" x-model="filters.provincia">
                <option value="">Selecciona Provincia</option>
                <template x-for="val in uniqueValues.provincia" :key="val">
                    <option :value="val" x-text="val"></option>
                </template>
            </select>
            <select name="region" x-model="filters.region">
                <option value="">Selecciona Región</option>
                <template x-for="val in uniqueValues.region" :key="val">
                    <option :value="val" x-text="val"></option>
                </template>
            </select>
            <select name="altura" x-model="filters.altura">
                <option value="">Selecciona Altura</option>
                <template x-for="val in uniqueValues.altura" :key="val">
                    <option :value="val" x-text="val + ' msnm'"></option>
                </template>
            </select>
            <select name="bodega" x-model="filters.bodega">
                <option value="">Selecciona Bodega</option>
                <template x-for="val in uniqueValues.bodega" :key="val">
                    <option :value="val" x-text="val"></option>
                </template>
            </select>
            <select name="año" x-model="filters.año">
                <option value="">Selecciona Año</option>
                <template x-for="val in uniqueValues.año" :key="val">
                    <option :value="val" x-text="val"></option>
                </template>
            </select>
            <select name="marca" x-model="filters.marca">
                <option value="">Selecciona Marca</option>
                <template x-for="val in uniqueValues.marca" :key="val">
                    <option :value="val" x-text="val"></option>
                </template>
            </select>
            <select name="variedad" x-model="filters.variedad">
                <option value="">Selecciona Variedad</option>
                <template x-for="val in uniqueValues.variedad" :key="val">
                    <option :value="val" x-text="val"></option>
                </template>
            </select>
            <button @click="clearFilters()">Limpiar Filtros</button>
        </section>
        <div x-show="!filteredWines.length" class="error-message">No se encontraron vinos. Ajusta los filtros o verifica la conexión.</div>
        <h3 class="section-title">Nuestros Vinos</h3>
        <div class="product-grid">
            <template x-for="wine in filteredWines" :key="wine.sku">
                <div class="product-card">
                    <img :src="wine.Imagen" :alt="wine.Nombre" :onerror="this.src='https://via.placeholder.com/200x200?text=Image+Not+Available';" />
                    <div class="info-icon" @click="toggleOverlay(wine.sku)">🍷</div>
                    <div class="overlay" :data-overlay-id="wine.sku">
                        <p x-text="wine.Descripción"></p>
                        <a :href="wine.url || '#'">Ver detalles</a>
                        <button @click="toggleOverlay(wine.sku)">Cerrar</button>
                    </div>
                    <h3 x-text="wine.Nombre"></h3>
                    <p class="price" x-text="'$' + wine.Precio.toFixed(2)"></p>
                    <a class="buy-button" :href="wine.url || '#'">Comprar</a>
                </div>
            </template>
        </div>
    </main>
</body>
</html>
